!function(e){var t={};function n(a){if(t[a])return t[a].exports;var r=t[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,n),r.l=!0,r.exports}n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)n.d(a,r,function(t){return e[t]}.bind(null,r));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="/",n(n.s=0)}([function(e,t,n){function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class r{constructor(e,t={}){return a(this,"defaultParams",{brandKey:null,trackingSiteId:null,articleTitle:null,articleTags:null,style:{},titleTag:"h2",titleText:"Vous souhaitez en savoir plus ?",titleTextMobile:"En savoir plus ?",textTag:"p",buttonText:"DÃ©couvrir ce produit",preventStyleInsertion:!1,extras:null,debug:!1}),this.element=e,this.params=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){a(e,t,n[t])})}return e}({},this.defaultParams,t),e&&e.ELEMENT_NODE?this.params.brandKey?this.params.trackingSiteId?this.params.articleTitle?void this.start():(this.log("No article title specified.","error"),!1):(this.log("No tracking site ID specified.","error"),!1):(this.log("No brand key specified.","error"),!1):(this.log("Element is required.","error"),!1)}log(e=null,t="log"){e&&this.params.debug&&("error"===t?console.error(`PercevalWidget : ${e}`):console.log(`PercevalWidget : ${e}`))}getData(){this.log("Sending data to the API...");const{brandKey:e,articleTitle:t,articleTags:n,extras:a}=this.params;let r="https://perceval.prismamediadigital.com/api/v1";return r+="/product",r+="?brandkey="+encodeURIComponent(e),r+="&title="+encodeURIComponent(t),n&&(r+="&tags="+encodeURIComponent(n)),a&&(r+="&extras="+encodeURIComponent(JSON.stringify(a))),new Promise((e,t)=>{const n=new window.XMLHttpRequest;n.onreadystatechange=(a=>{a.currentTarget.readyState===window.XMLHttpRequest.DONE&&(200===n.status?e(JSON.parse(n.responseText)):t(n.statusText))}),n.open("GET",r,!0),n.send(null)})}truncateString(e,t){return e.length<t?e:e.substring(0,t).replace(/\s+\S*$/,"")+"..."}getStyle(){this.log("Getting styles...");const e=this.params.style,t=document.createElement("style");return t.type="text/css",t.innerHTML=`\n      .perceval {\n        display: flex;\n        position: relative;\n        padding-bottom: 50px;\n        background-color: #F6F7F7;\n        font-family: ${e.fontFamily||"inherit"};\n      }\n      @media (min-width : 768px) {\n        .perceval {\n          padding-bottom: 0;\n        }\n      }\n      .perceval * {\n        box-sizing: border-box;\n      }\n      .perceval .perceval-imagewrapper {\n        display: flex;\n        flex-basis: 130px;\n        flex-grow: 0;\n        flex-shrink: 0;\n        padding: 15px;\n        background-color: #fff;\n        border: 3px solid #F6F7F7;\n      }\n      @media (min-width : 480px) {\n        .perceval .perceval-imagewrapper {\n          flex-basis: 240px;\n          padding: 30px;\n        }\n      }\n      .perceval .perceval-image {\n        width: 100%;\n        align-self: center;\n      }\n      .perceval .perceval-contentwrapper {\n        display: flex;\n        flex-direction: column;\n        justify-content: center;\n        width: calc(100% - 130px);\n        padding: 25px;\n      }\n      @media (min-width : 480px) {\n        .perceval .perceval-contentwrapper {\n          width: auto;\n          padding: 40px;\n        }\n      }\n      .perceval .perceval-title.mobile {\n        margin: 0 0 20px 0;\n        color: ${e.titleFontColor||"#000"};\n        font-size: ${e.titleFontSizeMobile||"20px"};\n        font-weight: ${e.titleFontWeightMobile||"800"};\n      }\n      .perceval .perceval-title.desktop {\n        display: none;\n      }\n      @media (min-width : 480px) {\n        .perceval .perceval-title.mobile {\n          display: none;\n        }\n        .perceval .perceval-title.desktop {\n          display: block;\n          margin: 0 0 20px 0;\n          color: ${e.titleFontColor||"#000"};\n          font-size: ${e.titleFontSize||"20px"};\n          font-weight: ${e.titleFontWeight||"800"};\n        }\n      }\n      .perceval .perceval-text {\n        margin: 0;\n        line-height: 150%;\n        color: ${e.textFontColor||"#000"};\n      }\n      .perceval .perceval-text.mobile {\n        display: block;\n        font-size: ${e.textFontSizeMobile||"13px"};\n        font-weight: ${e.textFontWeightMobile||"700"};\n      }\n      .perceval .perceval-text.desktop {\n        display: none;\n      }\n      @media (min-width : 480px) {\n        .perceval .perceval-text.mobile {\n          display: none;\n        }\n        .perceval .perceval-text.desktop {\n          display: block;\n          margin-bottom: 20px;\n          font-size: ${e.textFontSize||"15px"};\n          font-weight: ${e.textFontWeight||"700"};\n        }\n      }\n      .perceval .perceval-button {\n        display: block;\n        position: absolute;\n        bottom: 0;\n        left: 0;\n        right: 0;\n        padding: 15px;\n        text-align: center;\n        background: ${e.buttonBgColor||"#000"};\n        color: ${e.buttonFontColor||"#fff"};\n        font-size: ${e.buttonFontSizeMobile||"15px"};\n        font-weight: ${e.buttonFontWeightMobile||"700"};\n      }\n      @media (min-width : 768px) {\n        .perceval .perceval-button {\n          padding: 20px;\n          font-size: ${e.buttonFontSize||"15px"};\n          font-weight: ${e.buttonFontWeight||"700"};\n        }\n      }\n      @media (min-width : 768px) {\n        .perceval .perceval-button {\n          position: static;\n          max-width: 330px;\n        }\n      }\n      .perceval .perceval-button,\n      .perceval .perceval-button:hover,\n      .perceval .perceval-button:visited,\n      .perceval .perceval-button:active,\n      .perceval .perceval-button:focus {\n        color: ${e.buttonFontColor||"#fff"};\n      }\n    `,t}getStructure(e){this.log("Building widget structure...");const t=document.createElement("section");t.className="perceval";const n=document.createElement("div");n.className="perceval-imagewrapper",t.appendChild(n);const a=document.createElement("img");a.className="perceval-image",a.src=e.urlImage,n.appendChild(a);const r=document.createElement("div");r.className="perceval-contentwrapper",t.appendChild(r);const i=document.createElement(this.params.titleTag);i.className="perceval-title desktop",i.innerHTML=this.params.titleText,r.appendChild(i);const o=document.createElement(this.params.titleTag);o.className="perceval-title mobile",o.innerHTML=this.params.titleTextMobile,r.appendChild(o);const l=document.createElement(this.params.textTag);l.className="perceval-text desktop",l.innerHTML=this.truncateString(e.description,180),r.appendChild(l);const s=document.createElement(this.params.textTag);s.className="perceval-text mobile",s.innerHTML=this.truncateString(e.description,75),r.appendChild(s);const c=`${e.urlProduct}?code=SIEWIDARTVPC&utm_source=${this.params.trackingSiteId}&utm_medium=sites-editos&utm_campaign=widget-contextuel-article`,p=document.createElement("a");return p.className="perceval-button",p.href=c,p.target="_blank",p.innerHTML=this.params.buttonText,r.appendChild(p),t}start(){this.log("Starting widget..."),this.getData().then(e=>e&&e.description?(this.params.preventStyleInsertion||document.querySelector("head").appendChild(this.getStyle()),this.element.appendChild(this.getStructure(e)),!0):(this.log("No product found."),!1)).catch(()=>(this.log("Error while retrieving data from the API.","error"),!1))}}document.querySelectorAll("*[data-perceval]").forEach(e=>{let t={};e.dataset.brandkey&&(t.brandKey=e.dataset.brandkey),e.dataset.trackingsiteid&&(t.trackingSiteId=e.dataset.trackingsiteid),e.dataset.articletitle&&(t.articleTitle=e.dataset.articletitle),e.dataset.articletags&&(t.articleTags=e.dataset.articletags),e.dataset.style&&(t.style=JSON.parse(e.dataset.style)),e.dataset.titletag&&(t.titleTag=e.dataset.titletag),e.dataset.texttag&&(t.textTag=e.dataset.texttag),e.dataset.buttontext&&(t.buttonText=e.dataset.buttontext),void 0!==e.dataset.preventstyleinsertion&&(t.preventStyleInsertion=!0),e.dataset.extras&&(t.extras=JSON.parse(e.dataset.extras)),void 0!==e.dataset.debug&&(t.debug=!0),new r(e,t)}),window.PercevalWidget=r}]);